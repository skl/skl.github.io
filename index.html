<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>skl</title>

<meta name="viewport" content="width-device-width, initial-scale=1">

<style type="text/css">
header,footer,nav,section,article,aside{display:block} html{font-size:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%} body{margin:0;font-size:1em;line-height:1.4em} ::-moz-selection{background:#333;color:#fff;text-shadow:none} ::selection{background:#333;color:#fff;text-shadow:none}a:focus{outline:thin dotted} a:hover,a:active {outline:0}

body{width:80%; max-width:500px; margin:0 auto; padding:5px 0; background:#dfd2a9; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif}
a:link,a:visited {opacity:0.8; color:black}
a:hover,a:active {opacity:1.0; color:black}

header{opacity:0.4; text-transform:uppercase; letter-spacing:0}
nav a:link,nav a:visited{text-decoration:none; font-size:0.625em; padding:10px 10px 10px 0}
article,footer{padding:0.25em 0 0 0; margin:0.25em 0 10em 0; border-top:1px solid #b2a787}
footer{opacity:0.4; font-size:0.625em; text-transform:uppercase; text-align:right}

h2 {opacity:0.4; text-transform:uppercase; font-size:0.875em; letter-spacing:0.085em}
h2 a {text-decoration:none}
p {opacity:0.8; font-size:0.875em}
</style>
</head>

<body>
    <header><nav>
        <a href="http://delicious.com/skl_">delicious</a>
        <a href="http://flickr.com/photos/stephenlang">flickr</a>
        <a href="http://instagram.com/skl85/">instagram</a>
        <a href="http://github.com/skl">github</a>
        <a href="http://www.linkedin.com/in/stephenkarllang">linkedin</a>
        <a href="https://twitter.com/skl_">twitter</a>
    </nav></header>

    <!-- 2013-01- -->
    <article id="building-a-xen-hypervisor">
    <h2><a href="#building-a-xen-hypervisor">ยง</a> Building a Xen Hypervisor</h2>

    <p>Several months ago I built an Intel Core i5 with a SATA III SSD, the intention was to turn it into a gaming machine. Now I find that I've not much time for gaming so I've decided to re-purpose the machine and take advantage of the hardware. One of my ongoing projects is to migrate my webservers and host from home to save on monthly cost and I thought this would be the perfect opportunity to explore the world of the hypervisor.<p>

    <p>Wikipedia states that <q>a hypervisor or virtual machine manager (VMM) is a piece of software, firmware or hardware that creates and runs virtual machines</q>.</p>

    <p>I started by reading about what operating systems were best suited to
    what I would've called the xen host, I now know the correct terminology to
    be "Domain 0" or <code>dom0</code>. In hypervisor terms each machine is a
    domain, including the host. It seems you can run Xen on a variety of linux
    distributions but I noticed quite a bit of documentation and articles
    focusing on Debian. For this reason I picked Debian Squeeze.</p>

    <p>The SSD which is the primary drive in the system is only 120 GiB, this
    doesn't leave much room for the VMs. Luckily the Xen wiki recommends LVM
    which is trivial to setup using the Debian installer. With the LVM
    partition in place on the drive I can easily grow and shrink partitions as
    requirements for each virtual machine changes over time.</p>

    <p>I'm keen to keep my web servers secure. One concern that struck me was
    that VMs would be able to access my home LAN as everything is connected to
    the same router. To solve this issue I setup four LAN subnets and 802.1q
    VLAN tagging. This is quite straight forward on Debian Squeeze.</p>

    <p>Setup the VLANs on your router and make note of the tag IDs (10, 20, 30
    and 40 in my case).</p>

    <p>Enable the 802.1q kernel module and make it permanent:</p>

<code><pre>
modprobe 8021q && echo '8021q' >> /etc/modules
</pre></code>

    <p>Once you've done that you'll need to install the vlan package:</p>

<code><pre>
apt-get install vlan
</code></pre>

    <p>Setup the /etc/network/interfaces with as many of the above VLANs as you
    require for that machine.</p>

    <p>In order to give the VMs within the VLANs internet access you'll need to
    enable IPv4 forwarding and NAT:</p>

<code><pre>
echo 1 > /proc/sys/net/ipv4/ip_forward
echo 'net.ipv4.ip_forward=1' > /etc/sysctl.conf
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</pre></code>

    <p>Ensuring that iptables retains these rules on boot can also be done in
    <kbd>/etc/network/interfaces</kbd>:</p>

<code><pre>
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
    pre-up iptables-restore < /etc/iptables.conf
    post-down iptables-save > /etc/iptables.conf
</pre></code>

    </article>

    <!-- 2013-01-16 22:37 -->
    <article id="a-website-in-a-single-http-request">
    <h2><a href="#a-website-in-a-single-http-request">ยง</a> A Website in a Single HTTP Request</h2>

    <p>This website has no assets. There are no CSS files, no external JavaScript sources files, no backend scripting engine and no database storage system. It's just one HTML file and that's it. I've decided to get back to basics with my personal site; maybe because I spend my working life optimising complex systems, it's a sort joyful escape.</p>

    <p>There's something about plain text that's always appealed to me. Besides character encoding there's not much really to worry about. I know what I'm typing now will display correctly on your laptop/phone/tablet, regardless of your browser &ndash; because there isn't really anything to go wrong. I guess it's like my first car in a way, forget about the electric windows, heated windscreen and all those other fancy gadgets and you still have a car.</p>

    <p>I must admit that resisting the temptation to use CSS3 transitions or pure JavaScript to spice up the interactivity layer is somewhat difficult. It does however provide a nice clean scope for the design. Either I can achieve it with raw HTML and a couple of lines of CSS or I'm simply not going to implement it here. I want to focus on the content of this site, I want to share what I'm learning as it's happening. Designing the next-best has been on my to-do list for too long.</p>

    <p>All content on this site is free to share, just like the web should be.</p>
    </article>

    <footer>Stephen Karl Lang <a href="http://creativecommons.org/licenses/by/3.0/">CC BY</a></footer>
</body>
</html>
